define("module/teacherUnLogin/class",["module/common/basics/common/classAdd","module/common/basics/common/classAddValid","module/common/basics/common/classSet"],function(require){require("module/common/basics/common/classAdd").addNewClassDialog(),require("module/common/basics/common/classSet").classSetting()}),define("module/common/basics/common/classAdd",["module/common/basics/common/classAddValid","validForm","module/common/ajax/teacherClass/classAjax","module/common/basics/common/md5"],function(require,exports){var classAddValid=require("module/common/basics/common/classAddValid");exports.addNewClassDialog=function(){$(".addNewClass").length>0?$(".addNewClass").live("click",function(){$.ajax({url:baseUrlName+"class/create/ms",type:"GET",dataType:"json",success:function(json){json.subject_type>0&&$("#teacher_subject").val(json.subject_type)}}),$.tiziDialog({title:"添加新班级",content:$("#inVislbleClass").html().replace("inVislbleClassForm_beta","inVislbleClassForm").replace("creatNewClassForm_beta","creatNewClassForm"),icon:null,width:600,ok:!1}),classAddValid.invite(),classAddValid.creat()}):(classAddValid.invite(),classAddValid.creat())}}),define("module/common/basics/common/classAddValid",["lib/Validform/5.3.2/Validform","module/common/ajax/teacherClass/classAjax","module/common/basics/common/showLogin","module/common/basics/common/md5","md5"],function(require,exports){require("lib/Validform/5.3.2/Validform");{var classAjax=require("module/common/ajax/teacherClass/classAjax");require("module/common/basics/common/md5")}exports.Validform_checktip=function(msg,o){if(!o.obj.is("form")){var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg),o.obj.next().show();var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg);var infoObj=o.obj.next(".ValidformInfo");2==o.type&&(infoObj.show(),o.obj.next().hide())}};var ValidformTip=null;ValidformTip=$(".join_class").length>0?3:exports.Validform_checktip,exports.creat=function(){var _Form=$(".creatNewClassForm").Validform({tiptype:ValidformTip,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){if(!$(".theGenusScholl_n").hasClass("undis")){if(0==$(".schoolsType_beta").val())return $.tiziDialog({content:"请选择学校类型"}),!1;if(""==$(".schollName").attr("value"))return $.tiziDialog({content:"请输入学校名称"}),!1;$("#schoolVal").attr("value",-1)}},callback:function(data){classAjax.common(data)}});_Form.addRule([{ele:"#set_year",datatype:"*",nullmsg:"请选择年份",errormsg:"选择错误！"},{ele:".classNameInput",datatype:"*1-12",nullmsg:"请输入班级名称",errormsg:"长度1-12字符之间"},{ele:"#teacher_subject",datatype:"*",nullmsg:"请选择授课科目",errormsg:"选择错误！"}])},exports.invite=function(){var _Form=$(".inVislbleClassForm").Validform({tiptype:$(".teacherUnLogin").length>0?3:exports.Validform_checktip,showAllError:!1,ajaxPost:!0,callback:function(data){classAjax.invite(data)}});_Form.addRule([{ele:".in_vislble_class_text",datatype:"*6-8",nullmsg:"请输入班级编号",errormsg:"长度6-8个字符"},{ele:"select",datatype:"*",nullmsg:"请选择授课科目",errormsg:"选择错误！"}])}}),define("module/common/basics/common/classSet",["module/common/basics/common/classAddValid","validForm","module/common/ajax/teacherClass/classAjax","module/common/basics/common/md5"],function(require,exports){require("module/common/basics/common/classAddValid");exports.classSetting=function(){$(".province li").live("click",function(){var _cityName=2==$(this).attr("data-id")||25==$(this).attr("data-id")||27==$(this).attr("data-id")||32==$(this).attr("data-id")||33==$(this).attr("data-id")||34==$(this).attr("data-id")||35==$(this).attr("data-id");if(_cityName?$(".city,.sctype,.school").hide():$(".county,.school").hide(),"active"!==$(this).attr("class")){var id=$(this).attr("data-id"),ismunicipality=$(this).attr("ismunicipality");$.ajax({url:baseUrlName+"class/area?id="+id,type:"GET",dataType:"json",success:function(json){for(var listr="",i=0;i<json.length;++i)listr+='<li data-id="'+json[i].id+'">'+json[i].name+"</li>";1==ismunicipality?($(".county").html(listr),$(".county").fadeIn()):($(".city").html(listr),$(".city").fadeIn())}})}}),$(".city li").live("click",function(){if("active"!==$(this).attr("class")){var id=$(this).attr("data-id");$.ajax({url:baseUrlName+"class/area?id="+id,type:"GET",dataType:"json",success:function(json){for(var listr="",i=0;i<json.length;++i)listr+='<li data-id="'+json[i].id+'">'+json[i].name+"</li>";$(".county").html(listr),$(".county").css("display","block")}})}}),$(".county li").live("click",function(){$.ajax({url:baseUrlName+"class/area/sctype",type:"GET",dataType:"json",success:function(json){for(var listr="",i=0;i<json.length;++i)listr+='<li data-id="'+json[i].id+'">'+json[i].name+"</li>";$(".sctype").html(listr),$(".sctype").fadeIn()}})}),$(".sctype li").live("click",function(){if("active"!==$(this).attr("class")){var sctype=$(this).attr("data-id"),county_id=$(".aui_content .county li.active").attr("data-id");$.ajax({url:baseUrlName+"class/schools?id="+county_id+"&sctype="+sctype,type:"GET",dataType:"json",success:function(json){for(var listr="",i=0;i<json.length;++i)listr+='<li data-id="'+json[i].id+'">'+json[i].schoolname+"</li>";$(".school").html(listr),$(".school").css("display","block")}})}$(".noMySchollBtn").length>0&&$(".noMySchollBtn").show()}),$(".schooLocation li").live("click",function(){$(this).addClass("active").siblings().removeClass("active")}),$(".noMySchollBtn").live("click",function(){var county=$(".schoolCounty li.active").attr("data-id"),sctype=$(".schoolGrade li.active").attr("data-id");$.tiziDialog({id:"setSchollID"}).close(),$(".theGenusScholl_n").removeClass("undis"),$(".theGenusScholl_y").addClass("undis"),$("#school_id").val(""),$("#area_county_id").val(county),$("#sctype").val(sctype)}),$("#resetSchool").live("click",function(){var _this=$(this);$.ajax({url:baseUrlName+"class/area?id=1",type:"GET",dataType:"json",success:function(json){for(var listr="",i=0;i<json.length;++i)listr+='<li data-id="'+json[i].id+'" ismunicipality="'+json[i].ismunicipality+'">'+json[i].name+"</li>";$(".province").html(listr),$(".province").fadeIn()}}),$(".noMySchollBtn").hide(),$.tiziDialog({id:"setSchollID",title:"选择学校",top:100,content:$("#resetSchoolPop").html().replace("resetSchoolPopCon_beta","resetSchoolPopCon"),icon:null,width:800,ok:function(){if(!($(".school li.active").length<1)){$(".theGenusScholl_n").addClass("undis"),$(".theGenusScholl_y").removeClass("undis");var school_id=($("#class_id").val(),$(".aui_content .school li.active").attr("data-id")),fullname="",province=$(".schoolProvice li.active").html(),city=$(".schoolCity li.active").html(),county=$(".schoolCounty li.active").html(),schoolname=$(".schoolName li.active").html();"undefined"==typeof city&&(city=""),fullname=province+city+county+schoolname,_this.hasClass("resetSchool")?($(".theGenusScholl_n").add("undis"),$("#school").html(fullname),$("#resetSchool").text("重设学校"),$("#schoolVal").val(school_id)):($("#schoolVal").val(school_id),$("#school").html(fullname),$("#resetSchool").text("重设学校"),$("#schoolVal").val()>0&&$(".schoolBox").find(".ValidformInfo,.Validform_checktip").hide())}},cancel:!0,close:function(){$(".city,.county,.sctype,.school").hide()}})}),$("#resetSchoolYear").live("click",function(){$.tiziDialog({title:"选择年份",content:$("#resetSchoolYearPop").html(),icon:null,width:400,ok:function(){var year=$("#set_year").val(),class_id=$("#set_year").attr("classid");$("#class_year").html()==year?$.tiziDialog({content:"班级入学年份修改成功.",icon:"succeed"}):$.tizi_ajax({url:baseUrlName+"class/update_info/year",type:"POST",dataType:"json",data:{year:year,class_id:class_id},success:function(json){1==json.code?$.tiziDialog({content:json.msg,icon:"succeed",ok:function(){$("#class_year").html(year)}}):-999==json.code?showLogin.show_login():$.tiziDialog({content:json.msg})},error:function(){$.tiziDialog({content:"系统忙，请稍后再试"})}})},cancel:!0})})}});