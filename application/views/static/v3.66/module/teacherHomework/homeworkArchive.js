define("module/teacherHomework/homeworkArchive",["lib/tizi_ajax/0.0.1/tizi_ajax","lib/artDialog/4.1.7/artDialog","module/common/method/common/height","module/common/basics/teacherHomework/homeworkValid","tizi_datatype","validForm","module/common/ajax/teacherHomework/homeworkAjax"],function(require,exports){require("lib/tizi_ajax/0.0.1/tizi_ajax"),require("lib/artDialog/4.1.7/artDialog"),exports.homeworkArchive={init:function(){this.page(),this.initPage()},initPage:function(){"function"!=typeof archive_page&&(archive_page=function(page){seajs.use("module/teacherHomework/homeworkArchive",function(ex){ex.homeworkArchive.page(page)})})},page:function(page){var type=$("#filter_type").attr("data_type");this.randerPage(page,type)},randerPage:function(page,type){(""==page||null==page||void 0==page)&&(page=""),content="",$.tizi_ajax({type:"GET",dataType:"json",url:baseUrlName+"paper/homework_archive/",async:!1,data:{rf:!0,type:type,page:page,ver:(new Date).valueOf()},success:function(data){data.errorcode?""!=data&&($(".archive_list").html(data.html),require("module/common/method/common/height").leftMenuBg(),seajs.use("module/teacherHomework/homeworkDownload",function(ex){ex.homeworkDownload.init()})):$.tiziDialog({content:data.error})}})},delete_log:function(page,type,slid){(""==page||null==page||void 0==page)&&(page=""),content="",$.tizi_ajax({type:"POST",dataType:"json",url:baseUrlName+"paper/homework_archive/delete_save_log",async:!1,data:{slid:slid},success:function(data){1==data.errorcode?seajs.use("module/teacherHomework/homeworkArchive",function(ex){ex.homeworkArchive.randerPage(page,type)}):$.tiziDialog({content:data.error})}})}};var homeworkValid=require("module/common/basics/teacherHomework/homeworkValid");exports.getCanlender=function(){var w=$(".Wdate"),myDate=new Date,y=myDate.getFullYear(),m=myDate.getMonth()+1,d=myDate.getDate();m=10>m?"0"+m:m,d=10>d?"0"+d:d;var h=y+"-"+m+"-"+d;w.attr("value",h),$("#start_hour").val(myDate.getHours()),$(".down_start_hour").val(myDate.getHours())},exports.setHomework=function(){exports.getCanlender(),seajs.use(["wdatePicker","tizi_ajax"],function(){$(".setHomework").live("click",function(){var empty=!1;$(".setHomeworkForm_beta").length<1&&$.tizi_ajax({type:"GET",dataType:"json",url:baseUrlName+"exercise_plan/exercise_plan_controller/assign_box",async:!1,data:{},success:function(data){return 1!=data.errorcode?!1:(data.empty&&(empty=!0),$("#setHomeworkPop").html(data.html),void 0)}}),$(".ex_name").val($(this).attr("logname")),$(".paper_id").val($(this).attr("paper_id")),empty?$.tiziDialog({title:"请先创建班级",content:$("#setHomeworkPop").html().replace("setHomeworkForm_beta","setHomeworkForm"),icon:null,ok:function(){window.location.href=baseUrlName+"teacher/class/my"},width:600,cancel:!0}):($.tiziDialog({title:"布置作业",content:$("#setHomeworkPop").html().replace("setHomeworkForm_beta","setHomeworkForm"),icon:null,width:600,ok:function(){if("checked"==$(".answerStyle").find("input").eq(0).attr("checked")){var startTime=$(".start_day").val()+$("#start_hour").val()+$("#start_min").val(),endTime=$(".end_day").val()+$("#end_hour").val()+$("#end_min").val();if(startTime>=endTime)return $.tiziDialog({title:"提示",content:"开始时间不能晚于结束时间！",width:600,ok:function(){},cancel:!0}),!1}return $(".setHomeworkForm").submit(),!1},cancel:!0}),homeworkValid.setHomeworkVid())})}),$(".deleteHomework").live("click",function(){var save_id=$(this).attr("save_id"),num=$(this).attr("num"),that=$(this);$.tiziDialog({content:"确定要删除么?",ok:function(){$.tizi_ajax({url:"/ep/ep/del_homework_save",type:"POST",data:{save_id:save_id},dataType:"json",success:function(data){$.tiziDialog({content:data.error,ok:function(){1==data.errorcode}}),that.parents("tr").remove(),$(".num").each(function(){var _num=$(this).text();_num>num&&(_num-=1,$(this).text(_num))}),$("a.deleteHomework").each(function(){var _num=$(this).attr("num");_num>num&&(_num-=1,$(this).attr("num",_num))})}})},cancel:!0})}),$(".deleteDownHomework").live("click",function(){$(this).parents("tr").remove()})},exports.answerStyle=function(){$(".answerStyle label").live("click",function(){$(".homeworkTime").hide(),"checked"==$(this).find("input").attr("checked")&&($(this).siblings(".homeworkTime").show(),exports.getCanlender())})}}),define("module/common/method/common/height",[],function(require,exports){exports.leftMenuBg=function(){var _wrapContentHeight=$("#wrapContent").height(),_slideHeight=$("#slide").height();_wrapContentHeight>_slideHeight?$("#slide").height(_wrapContentHeight):$("#wrapContent").height(_slideHeight)}}),define("module/common/basics/teacherHomework/homeworkValid",["lib/tizi_common/0.0.1/tizi_datatype","lib/Validform/5.3.2/Validform","module/common/ajax/teacherHomework/homeworkAjax","module/common/basics/common/showLogin"],function(require,exports){require("lib/tizi_common/0.0.1/tizi_datatype").dataType();require("lib/Validform/5.3.2/Validform");var homeworkAjax=require("module/common/ajax/teacherHomework/homeworkAjax");exports.setHomeworkVid=function(){var varFeedbackCheck=$(".setHomeworkForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){homeworkAjax.assign(data)}});varFeedbackCheck.addRule([{ele:":checkbox:last",datatype:"*",nullmsg:"请选择班级",errormsg:"选择错误！"},{ele:":radio:last",datatype:"*",nullmsg:"请选择作答方式",errormsg:"选择错误！"}])}}),define("module/common/ajax/teacherHomework/homeworkAjax",["module/common/basics/common/showLogin"],function(require,exports){require("module/common/basics/common/showLogin");exports.assign=function(data){if(1==data.errorcode)var icon="succeed";else var icon=null;$.tiziDialog({content:data.error,icon:icon,ok:function(){data.errorcode&&(window.location.href=data.res.url)},close:function(){}})}});