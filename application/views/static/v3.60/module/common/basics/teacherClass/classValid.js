define("module/common/basics/teacherClass/classValid",["lib/tizi_common/0.0.1/tizi_datatype","module/common/ajax/teacherClass/classAjax","module/common/basics/common/showLogin","module/common/basics/common/md5","md5"],function(require,exports){var sDataType=require("lib/tizi_common/0.0.1/tizi_datatype").dataType(),classAjax=require("module/common/ajax/teacherClass/classAjax"),teacherMd5=require("module/common/basics/common/md5");exports.alterClassGrade=function(){var _Form=$(".alterClassGradePopForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){$(".classId").val($("#class_id").val())},callback:function(data){classAjax.alterClassGrade(data)}});_Form.addRule([{ele:".newClassGrade",datatype:"*1-50",nullmsg:"请输入文件夹名称",errormsg:"长度1-50字符之间"}])},exports.creat=function(){var _Form=$(".creatNewClassForm").Validform({tiptype:function(msg,o){if(!o.obj.is("form")){var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg),o.obj.next().show();var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg);var infoObj=o.obj.next(".ValidformInfo");2==o.type&&(infoObj.show(),o.obj.next().hide())}},showAllError:!1,ajaxPost:!0,callback:function(data){classAjax.common(data)}});_Form.addRule([{ele:"#set_year",datatype:"*",nullmsg:"请选择年份",errormsg:"选择错误！"},{ele:".classNameInput",datatype:"*1-12",nullmsg:"请输入班级名称",errormsg:"长度1-12字符之间"},{ele:"#teacher_subject",datatype:"*",nullmsg:"请选择授课科目",errormsg:"选择错误！"}])},exports.invite=function(){var _Form=$(".inVislbleClassForm").Validform({tiptype:function(msg,o){if(!o.obj.is("form")){var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg),o.obj.next().show();var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg);var infoObj=o.obj.next(".ValidformInfo");2==o.type&&(infoObj.show(),o.obj.next().hide())}},showAllError:!1,ajaxPost:!0,callback:function(data){classAjax.invite(data)}});_Form.addRule([{ele:".in_vislble_class_text",datatype:"*6-8",nullmsg:"请输入班级编号",errormsg:"长度6-8个字符"},{ele:"select",datatype:"*",nullmsg:"请选择授课科目",errormsg:"选择错误！"}])},exports.createStudent_new=function(){var _Form=$(".createStudentName").Validform({tiptype:function(msg,o){if(!o.obj.is("form")){var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg),o.obj.next().show();var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg);var infoObj=o.obj.next(".ValidformTips");2==o.type&&(infoObj.show(),o.obj.next().hide())}},showAllError:!1,ajaxPost:!0,beforeSubmit:function(curform){$(".classId").val($("#class_id").val()),teacherMd5.md5(curform)},callback:function(data){classAjax.createStudent(data)}});_Form.addRule([{ele:".studentNames_new",datatype:"*",nullmsg:"请输入姓名",errormsg:"至少需要输入一个姓名！"}])},exports.createStudentHasCount=function(){var _Form=$(".createStudentHasCount").Validform({tiptype:function(msg,o){if(!o.obj.is("form")){var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg),o.obj.next().show();var objtip=o.obj.next().find(".Validform_checktip");objtip.text(msg);var infoObj=o.obj.next(".ValidformTips");2==o.type&&(infoObj.show(),o.obj.next().hide())}},showAllError:!1,ajaxPost:!0,beforeSubmit:function(curform){$(".classId").val($("#class_id").val()),Common.comValidform.md5(curform)},callback:function(data){classAjax.createStudent(data)}});_Form.addRule([{ele:".stuAccName",datatype:"*",nullmsg:"请输入账号",errormsg:"请输入账号！"}])},exports.deleteClass=function(class_id){var _Form=$(".deleteClassPopForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(curform){$(".classId").val(class_id),teacherMd5.md5(curform)},callback:function(data){classAjax.common(data)}});_Form.addRule([{ele:".in_vislble_class_text",datatype:sDataType.Passwd.datatype,nullmsg:sDataType.Passwd.nullmsg,errormsg:sDataType.Passwd.errormsg}])}}),define("lib/tizi_common/0.0.1/tizi_datatype",[],function(require,exports){exports.dataType=function(){var _type={URname:{datatype:"*2-20",nullmsg:"请输入真实姓名",errormsg:"长度2-20个字符"},Uname:{datatype:"/^[a-zA-Z]{1}\\w{5,17}$/",nullmsg:"请输入用户名",errormsg:"以英文字母开头，6-18个英文或数字"},Stuid:{datatype:"/^\\d{8,10}$/",nullmsg:"请输入学号",errormsg:"长度8-10个数字"},Username:{datatype:"e | *6-20",nullmsg:"请输入邮箱/手机号/用户名/学号",errormsg:"长度6-20个字符"},Email:{datatype:"e",nullmsg:"请输入邮箱地址",errormsg:"请输入正确的邮箱地址"},Phone:{datatype:"m",nullmsg:"请输入手机号码",errormsg:"请输入正确的手机号码"},PhoneCode:{datatype:"/^\\d{6}$/",datatype_allownull:"/^\\d{6}$/ | /^\\w{0}$/",nullmsg:"请输入验证码",errormsg:"验证码长度是6位"},CaptchaCode:{datatype:"/^\\w{4}$/",nullmsg:"请输入验证码",errormsg:"验证码长度是4位"},QQ:{datatype:"n5-12 | /^\\w{0}$/",datatype_nonull:"n5-12",nullmsg:"请输入QQ号码！",errormsg:"长度5-12个数字"},Passwd:{datatype:"*6-16",nullmsg:"请输入密码",errormsg:"长度6-16个字符之间",old_nullmsg:"请输入旧密码",re_nullmsg:"请再次输入密码",re_errormsg:"两次密码不一致！",new_nullmsg:"请输入新密码",re_new_nullmsg:"请再次输入新密码"},Dname:{datatype:"/^[a-zA-Z]{1}[a-zA-Z_0-9]{3,17}$/",nullmsg:"请输入个性域名",errormsg:"以英文字母开头，4-18个英文，数字或下划线"},Oname:{datatype:"*2-20",nullmsg:"请输入单位名称",errormsg:"长度2-20个字符"},Classname:{datatype:"*1-12",nullmsg:"请输入班级名称",errormsg:"长度1-12个字符"},Classnum:{datatype:"*6-8",nullmsg:"请输入班级编号",errormsg:"长度6-8个字符"},radioValid:{datatype:"*"}};return _type}}),define("module/common/ajax/teacherClass/classAjax",["module/common/basics/common/showLogin"],function(require,exports){var showLogin=require("module/common/basics/common/showLogin");exports.common=function(data){1==data.code?$.tiziDialog({content:data.msg,icon:"succeed",ok:function(){window.location.href=data.redirect}}):-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.invite=function(data){1==data.code?window.location.href=data.redirect:-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.deleteClass=function(data){1==data.code?($.tiziDialog.list.deleteClassId.close(),$.tiziDialog({content:data.msg,icon:"succeed",ok:function(){window.location.reload()}})):-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.createStudent=function(data,type){if(1==data.code){var st=data.students;ga("send","event","CreateStudent-"+type,"CreateStudent",type,data.students.length),$.tiziDialog({content:data.msg+"<br />请将学号和密码告知您的学生，尽快登录。",icon:"succeed",ok:function(){for(var tr="",i=0;i<data.students.length;++i){var atr=$("#crtemplate").html();atr=atr.replace("%student_name%",st[i].student_name),atr=atr.replace("%student_id%",st[i].student_id),atr=atr.replace("%student_id%",st[i].student_id),atr=atr.replace("%password%",st[i].password),tr+=atr}$.browser.msie&&"7.0"==$.browser.version||$.browser.msie&&"6.0"==$.browser.version?($(".myallClass_student").append("<tr>"+tr+"</tr>"),$(".myallClass_student tr").each(function(){""==$(this).html()&&$(this).remove()})):$(".myallClass_student").append(tr);var student_total=parseInt($("#student_total").text());$("#student_total").text(student_total+data.students.length),$("#dlacc").css("display","inline-block"),$("#havestudentdiv").css("display","block"),$(".emptyNotice").css("display","none")}})}else-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.teacherInputStudent=function(data){if(1==data.code){var st=data.students;$.tiziDialog({content:data.msg,icon:"succeed",ok:function(){for(var tr="",i=0;i<data.students.length;++i){var atr=$("#crtemplate").html();atr=atr.replace("%student_name%",st[i].student_name),atr=atr.replace("%student_id%",st[i].student_id),atr=atr.replace("%student_id%",st[i].student_id),atr=atr.replace("%password%",st[i].password),atr=atr.replace("学生还未激活帐号",st[i].lastactive),tr+=atr}$.browser.msie&&"7.0"==$.browser.version||$.browser.msie&&"6.0"==$.browser.version?($(".myallClass_student").append("<tr>"+tr+"</tr>"),$(".myallClass_student tr").each(function(){""==$(this).html()&&$(this).remove()})):$(".myallClass_student").append(tr);var student_total=parseInt($("#student_total").text());$("#student_total").text(student_total+data.students.length),1==data.code&&(window.location.href=window.location.href)}})}else-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.alterClassGrade=function(data){1==data.code?$.tiziDialog({content:data.msg,icon:"succeed",ok:function(){var _name=data.name;$("#ClassGrade").text(_name),$("#lft_"+$("#class_id").val()).text(_name)}}):-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.deleteClass=function(data){1==data.code?($.tiziDialog.list.deleteClassId.close(),$.tiziDialog({content:data.msg,icon:"succeed",ok:function(){window.location.reload()}})):-999==data.code?showLogin.show_login():$.tiziDialog({content:data.msg})},exports.acceptInvite=function(data){1==data.code?$.tiziDialog({content:data.msg,icon:"succeed",close:function(){window.location.href=data.redirect}}):$.tiziDialog({content:data.msg,close:function(){data.redirect&&(window.location.href=data.redirect)}})}}),define("module/common/basics/common/showLogin",[],function(require,exports){exports.show_login=function(){$.tiziDialog({content:json.msg,icon:"question",ok:function(){window.location.href=baseUrlName+"login"},cancel:!0})}}),define("module/common/basics/common/md5",["lib/md5/0.0.1/md5"],function(require,exports){require("lib/md5/0.0.1/md5"),exports.md5=function(element){var i=0;element.find("input").each(function(){if("password"==$(this).attr("type")){var input_name=$(this).attr("name");void 0==input_name&&(input_name=$(this).attr("md5_name")),input_name&&(i+=1);var input_id=input_name+i,pass_hidden='<input class="text-input" id="'+input_id+'_md5" name="'+input_name+'" type="hidden">';$("#"+input_id+"_md5").remove(),$(this).parent().append(pass_hidden),$("#"+input_id+"_md5").val(tizi_md5($(this).val())),$(this).attr("md5_name",input_name).removeAttr("name")}})},exports.reset_md5=function(element){var i=0;$(element).find("input").each(function(){if("password"==$(this).attr("type")){input_name=$(this).attr("md5_name"),input_name&&(i+=1);var input_id=input_name+i;$("#"+input_id+"_md5").remove(),$(this).attr("name",input_name).removeAttr("md5_name")}})}});