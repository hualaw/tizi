define("module/teacherTestLibrary/myQuestions",["module/common/basics/teacherTestLibrary/valid","tizi_ajax","validForm","module/common/ajax/teacherTestLibrary/validAjax"],function(require,exports){var _valid=require("module/common/basics/teacherTestLibrary/valid");exports.showAnswer=function(){$(".ques-body").live("click",function(){$(this).find(".ansBox").stop(!0,!0).slideToggle(200)})},exports.addNewGroup=function(){var newGroup=$(".newGroup"),ucDoc_nav=$("#ucDoc_nav");newGroup.live("click",function(){$.tiziDialog({id:"AddDocForm",content:ucDoc_nav.html().replace("addDocForm_beta","addDocForm"),icon:null,title:"新建试题分组",ok:function(){return $(".addDocForm").submit(),!1},cancel:!0});_valid.addNewGroupValid()})},exports.editNewGroup=function(){var edit_doc=$(".edit_doc"),ucDoc_Editor=$("#ucDoc_Editor");edit_doc.live("click",function(){var that=$(this);$(".group_gid").val(that.data("gid"));var element=that.parents("tr").find(".group-name").find("a"),title=element.text();ucDoc_Editor.find("input[name=new_name]").attr("value",title);$.tiziDialog({id:"EditDocForm",content:ucDoc_Editor.html().replace("editDocForm_beta","editDocForm"),icon:null,title:"编辑试题分组",ok:function(){return $(".editDocForm").submit(),!1},cancel:!0});_valid.EditNewGroupValid(that)})},exports.delNewGroup=function(){$(".del_doc").live("click",function(){var that=($(".doc_group li").eq(1),$(this));if("disabled"==that.attr("disabled"))return!1;that.attr("disabled","disabled");{var title=that.parents("tr").find(".group-name").find("a").text(),content='<div class="teacherTestLibrary"><div class="myGroupInput"><h2>是否确定删除分组：<b style="color: #ff6600;">'+title+"</b>？</h2><h2>删除分组后，该分组中的文档将标记为未分组。</h2></div></div>",baseuri=baseUrlName+"user/user_question/update_group",subject_id=$(".subNavBox").data("subject"),group_id=that.data("gid"),post_data={sid:subject_id,gid:group_id,op_type:"delete"};$.tiziDialog({content:content,icon:null,title:"删除试题分组",ok:function(){$.tizi_ajax({url:baseuri,type:"POST",data:post_data,dataType:"json",success:function(data){0==data.error_code?$.tiziDialog({content:data.error}):(that.parents("tr").remove(),that.parents(".grop_list").find(".paperNum").eq(0).html(data.count))}})},cancel:!0})}})},exports.myquestionPage=function(ele){ele=ele||1;var groupID=$(".questionAddress").data("gid"),subjectID=$(".subNavBox").data("subject"),getData={subject:subjectID,page:ele,gid:groupID,ver:(new Date).valueOf()};$.tizi_ajax({url:baseUrlName+"user/user_question/ajax_get_teacher_question",type:"GET",data:getData,dataType:"json",success:function(data){1==data.errorcode?$("#ajax_content").html(data.html):$.tiziDialog({content:data.error})}})},exports.delQues=function(){var content='<div class="md_docText"><h2 style="font-size:16px;font-weight:normal">是否确定删除此题目?</h2></div>';$(".del_ques").live("click",function(){var that=$(this);if("disabled"==that.attr("disabled"))return!1;that.attr("disabled","disabled");{var subject_id=$(".subNavBox").data("subject"),getData={qid:that.data("num"),sid:subject_id,ver:(new Date).valueOf()};$.tiziDialog({content:content,icon:null,title:"删除题目",ok:function(){$.tizi_ajax({url:baseUrlName+"user/user_question/del_question",type:"GET",data:getData,dataType:"json",success:function(data){1==data.error_code?exports.myquestionPage(1):$.tiziDialog({content:data.error})}})},cancel:function(){that.removeAttr("disabled")}})}})}}),define("module/common/basics/teacherTestLibrary/valid",["lib/tizi_ajax/0.0.1/tizi_ajax","lib/Validform/5.3.2/Validform","module/common/ajax/teacherTestLibrary/validAjax"],function(require,exports){require("lib/tizi_ajax/0.0.1/tizi_ajax"),require("lib/Validform/5.3.2/Validform");var _validAjax=require("module/common/ajax/teacherTestLibrary/validAjax");exports.addNewGroupValid=function(){var _Form=$(".addDocForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){_validAjax.addNewGroupValidAjax(data)}});_Form.addRule([{ele:".group_name",datatype:"*2-20",nullmsg:"分组名称不能为空",errormsg:"请输入2-20个字符"}])},exports.EditNewGroupValid=function(that){var _Form=$(".editDocForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){_validAjax.EditNewGroupValidAjax(data,that)}});_Form.addRule([{ele:".group_name",datatype:"*2-20",nullmsg:"分组名称不能为空",errormsg:"请输入2-20个字符"}])},exports.uploadQuesValid={init:function(){this.myQuestion()},myQuestion:function(){var _Form=$(".form_qList").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){_validAjax.uploadQuesAjax.myQuestion(data)}});_Form.addRule([{ele:".s_grade",datatype:"*",nullmsg:"请选择学段"},{ele:".s_subject",datatype:"*",nullmsg:"请选择学科"},{ele:".s_qtype",datatype:"*",nullmsg:"请选择题型"},{ele:".source",datatype:"*",nullmsg:"请输入题目/来源"}])},myGroupTipForm:function(obj){var _Form=$(".myGroupTipForm").Validform({tiptype:3,showAllError:!1,ajaxPost:!0,beforeSubmit:function(){},callback:function(data){_validAjax.uploadQuesAjax.myGroupTipForm(data,obj)}});_Form.config({tiptype:3}),_Form.addRule([{ele:".s_newSubject",datatype:"*",nullmsg:"请选择学科"},{ele:".s_GroupName",datatype:"*1-20",nullmsg:"请选择分组名称",errormsg:"长度1-20字符之间"}])}}}),define("module/common/ajax/teacherTestLibrary/validAjax",[],function(require,exports){exports.addNewGroupValidAjax=function(data){if(0==data.error_code)$.tiziDialog({content:data.error});else{var group_name=data.new_name,bindUrl=baseUrlName+"teacher/user/myquestion/g/"+data.error,doc_str='<tr><td class="questionGrop group-name"><a href="'+bindUrl+'" data-gid="'+data.error+'">'+group_name+'</a></td><td class="paperNum">0 道</td><td class="operation"><a href="javascript:void(0)" data-gid="'+data.error+'" class="edit_doc">编辑</a>&nbsp;<a href="javascript:void(0)" class="del_doc">删除</a></td></tr>';$(doc_str).insertAfter(".grop_list tbody tr:eq(1)"),$.tiziDialog.list.AddDocForm.close()}},exports.EditNewGroupValidAjax=function(data,that){var ele=that;0==data.error_code?$.tiziDialog({content:data.error}):(ele.parents("tr").find(".group-name").find("a").text(data.new_group_name),art.dialog.list.EditDocForm.close())},exports.uploadQuesAjax={myQuestion:function(data){if(data.error_code){var type=data.type,title="insert"==type?"继续上传":"继续编辑";$.tiziDialog({content:data.error,okVal:title,cancelVal:"查看我的试题",ok:function(){this.close(),"insert"==type&&(window.location.href=baseUrlName+"teacher/user/myquestion/new")},cancel:function(){var optionId=$(".s_subject option:selected").val();window.location.href=baseUrlName+"teacher/user/myquestion/"+optionId}})}else $.tiziDialog({content:data.error})},myGroupTipForm:function(data,obj){var oldGroup=obj.parent().find(".s_Group");if(data.error_code){var newGroupName=data.new_name,newGroupID=data.error,newOption='<option value ="'+newGroupID+'" selected="selected">'+newGroupName+"</option>";oldGroup.removeAttr("selected"),oldGroup.append(newOption),$.tiziDialog.list.tmpGroupTipId.close()}else $.tiziDialog({content:data.error})}}});