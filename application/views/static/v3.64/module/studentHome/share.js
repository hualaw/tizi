define("module/studentHome/share",["lib/tizi_ajax/0.0.1/tizi_ajax","lib/artDialog/4.1.7/artDialog","lib/tizi_common/0.0.1/tizi_download","cookies","tizi_ajax","tiziDialog"],function(require,exports){require("lib/tizi_ajax/0.0.1/tizi_ajax"),require("lib/artDialog/4.1.7/artDialog");var Teadownload=require("lib/tizi_common/0.0.1/tizi_download");exports.downloadShare=function(){$(".download_share").live("click",function(){var file_name=$(this).attr("file_name"),file_id=$(this).attr("file_id"),share_id=$(this).attr("share_id");$.tizi_ajax({url:baseUrlName+"teacher/cloud/download_verify",type:"POST",data:{file_id:file_id,file_name:file_name},dataType:"json",success:function(data){if(0==data.errorcode)$.tiziDialog({content:data.error});else if(1==data.file_type){var down_url=baseUrlName+"student/cloud/download?url="+data.file_path+"&file_name="+data.file_name+"&file_id="+data.file_id+"&share_id="+share_id;Teadownload.force_download(down_url,data.fname,!0)}else stu_force_download(data.url,data.fname,!0,!0,share_id)}})})};var stu_force_download=function(url,fname,openbox,is_qiniu,share_id){"undefined"==is_qiniu&&(url=url+"&session_id="+$.cookies.get(baseSessID));var ie_ver=ie_version();return 1==openbox||6==ie_ver||7==ie_ver||8==ie_ver?(fname=""==fname||void 0==fname?"是否下载？":"是否下载《"+fname+"》？",$.tiziDialog({content:fname,ok:null,icon:null,button:[{name:"点击下载",href:url,className:"aui_state_highlight clickDown",target:"_self"}]}),$(".clickDown").click(function(){1==is_qiniu&&$.tizi_ajax({url:baseUrlName+"student/cloud/add_download_count",type:"POST",data:{share_id:share_id},dataType:"json",success:function(){}})}),!1):(window.location.href=url,void 0)},ie_version=function(){var ie=$.browser.msie,version=$.browser.version;return ie?version:!1};exports.love_share=function(){$(".zan").live("click",function(){var share_id=$(this).attr("share_id"),that=$(this);$.tizi_ajax({url:baseUrlName+"student/cloud/love",type:"POST",dataType:"json",data:{share_id:share_id},success:function(json){if(1==json.errorcode){var love=Number(that.parents().find(".get_love").attr("value"))+1;that.parent().find(".get_love").text("获赞("+love+")"),that.remove()}else $.tiziDialog({content:json.error})},error:function(){$.tiziDialog({content:"系统繁忙，请稍后再试"})}})})}}),define("lib/tizi_common/0.0.1/tizi_download",["lib/cookies/0.0.1/jquery.cookies","lib/tizi_ajax/0.0.1/tizi_ajax","lib/artDialog/4.1.7/artDialog"],function(require,exports){require("lib/cookies/0.0.1/jquery.cookies"),require("lib/tizi_ajax/0.0.1/tizi_ajax"),require("lib/artDialog/4.1.7/artDialog"),exports.force_download=function(url,fname,openbox,noxunlei){noxunlei||(url=url+"&session_id="+$.cookies.get(baseSessID));var ie_ver=exports.ie_version();return 1==openbox||6==ie_ver||7==ie_ver||8==ie_ver?(fname=""==fname||void 0==fname?"请点击下载":"请点击下载《"+fname+"》",$.tiziDialog({content:fname,ok:!1,cancel:!1,dblclick:!1,icon:null,button:[{name:"点击下载",href:url,className:"aui_state_highlight",target:"_self"}]}),!1):(window.location.href=url,void 0)},exports.ie_version=function(){var ie=$.browser.msie,version=$.browser.version;return ie?version:!1},exports.down_confirm_box=function(url,fname,noxunlei){noxunlei||(url=url+"&session_id="+$.cookies.get(baseSessID)),$.tiziDialog({content:"是否下载文件《"+fname+"》？",ok:!1,cancel:!0,icon:null,button:[{name:"点击下载",href:url,className:"aui_state_highlight",target:"_self"}]})}});