$(".logoutCheck").live("click",function(){var redirect=$(this).attr("dest");redirect||(redirect=$(this).attr("href")),$.tizi_ajax({url:loginUrlName+"logout/check",type:"get",dataType:"jsonp",data:{redirect:redirect},success:function(data){data.errorcode?"reload"==data.redirect?window.location.reload():data.redirect&&(window.location.href=data.redirect):window.location.reload()}})});var Common={headerNav:function(json){var _id=json.id,_ul=json.ul,_dis=json.dis;$(_id).hover(function(){$(this).find(_ul).addClass(_dis)},function(){})}};!function($){$.tizi_callback=function(data,success){return void 0!=data?data.login===!1?(window.location.href=baseUrlName,!1):data.token===!1?(window.location.reload(),!1):(""!=data.token&&void 0!=data.token&&(basePageToken=data.token),void 0==success&&(success=function(){}),success(data),void 0):void 0},$.tizi_token=function(options_data,type,serialize,callback_name){if(serialize===!0){var len=options_data.length;if(options_data[len]={name:"ver",value:(new Date).valueOf()},"post"==type.toLocaleLowerCase()&&(options_data[len+1]={name:"token",value:basePageToken},options_data[len+2]={name:"page_name",value:basePageName}),callback_name){var len=options_data.length;options_data[len]={name:"callback_name",value:callback_name}}}else options_data.ver=(new Date).valueOf(),"post"==type.toLocaleLowerCase()&&(options_data.token=basePageToken,options_data.page_name=basePageName),callback_name&&(options_data.callback_name=callback_name);return options_data},$.tizi_ajax=function(options,serialize){var defaults={url:"",type:"POST",data:{},dataType:"json",async:!0,success:function(){},error:function(){}},options=$.extend(defaults,options);if("jsonp"==options.dataType){options.jsonp="callback",options.data=$.tizi_token(options.data,options.type,serialize,options.jsonp);var success=options.success;callback=function(data){$.tizi_callback(data,success)},options.success=function(){},options.error=function(){}}else{options.dataType="json",options.data=$.tizi_token(options.data,options.type,serialize);var success=options.success;options.success=function(data){$.tizi_callback(data,success)}}$.ajax(options)}}(jQuery);var TeacherAq={};TeacherAq.answerAdmin={claimQuestionFn:function(){$(".claimQuestion input").click(function(){$.tizi_ajax({url:baseUrlName+"teacher/aq_teacher/take_question",type:"POST",dataType:"json",data:{question_id:$("#question_id").val()},success:function(json){1==json.errorcode?window.location=baseUrlName+"aq_teacher/aq_teacher/question_detail/"+$("#question_id").val():$.tiziDialog({content:json.error})},error:function(){$.tiziDialog({content:"系统忙，请稍后再试"})}})})},aq_questionListFn:function(){$(".aq_questionList .box").click(function(){window.location.href=$(this).attr("url")}),$(".aq_questionList .box").hover(function(){$(this).find(".bd").css("color","#298d6a")},function(){$(this).find(".bd").css("color","")})},aq_my_questionListFn:function(){$(".aQuestionCon .cf").click(function(){window.open($(this).attr("url"))}),$(".aQuestionCon li").hover(function(){$(this).find("p").css("color","#298d6a").css("cursor","pointer")},function(){$(this).find("p").css("color","").css("cursor","default")})},aq_comment_pagination:function(offset){urls=baseUrlName+"aq_teacher/aq_teacher/comments",(""==offset||null==offset||void 0==offset)&&(offset=""),content="",$.ajax({type:"GET",dataType:"text",url:urls,async:!1,data:{rf:!0,offset:offset},success:function(data){content=data,""!=data&&$(".comment_content").html(content)}})},aq_my_question_pagination:function(offset){urls=baseUrlName+"aq_teacher/aq_teacher/my_question",(""==offset||null==offset||void 0==offset)&&(offset=""),content="",$.ajax({type:"GET",dataType:"text",url:urls,async:!1,data:{rf:!0,offset:offset,is_resolved:$("#is_resolved").val()},success:function(data){content=data,""!=data&&$(".aQuestionCon").html(content)}})},aq_upload_pic_answer:function(){$(".aqupload").each(function(){var node=$(this),loading=staticUrlName+"image/answerquestion/loading.gif",upload_id=node.attr("id");$("#"+upload_id).uploadify({formData:$.tizi_token({session_id:$.cookies.get(baseSessID)},"post"),swf:staticBaseUrlName+staticVersion+"lib/uploadify/2.2/uploadify.swf",uploader:baseUrlName+"upload/taqask?id="+upload_id,multi:!1,buttonClass:"choseFileBtn",buttonText:"上传文件",fileTypeExts:"*.jpg; *.png;*.gif",fileSizeLimit:"2048KB",fileObjName:upload_id,width:102,height:28,overrideEvents:["onSelectError","onDialogClose"],onUploadStart:function(){$("."+upload_id).html('<img src="'+loading+'" class="imgloading"/>')},onSWFReady:function(){},onFallback:function(){$(".imgTips").html(noflash)},onSelectError:function(file,errorCode){switch(errorCode){case-110:$.tiziDialog({content:"文件 ["+file.name+"] 过大！每张图片不能超过2M"});break;case-120:$.tiziDialog({content:"文件 ["+file.name+"] 大小异常！不可以上传大小为0的文件"});break;case-130:$.tiziDialog({content:"文件 ["+file.name+"] 类型不正确！不可以上传错误的文件格式"})}return!1},onUploadSuccess:function(file,data){var json=JSON.parse(data);1==json.code?($("."+upload_id).removeClass("red"),$("."+upload_id).html('<img src="'+json.img_path+'" class="picture_urls"/>'),$("#_picture").val(json.img_path)):($("."+upload_id).html("<b>"+json.msg+"</b>"),$("."+upload_id).addClass("red")),$("."+upload_id).siblings(".clearpic").show(),$("."+upload_id).siblings(".clearpic").on("click",function(){$("."+upload_id).find("img").remove(),$("."+upload_id).siblings(".clearpic").hide(),$("."+upload_id).removeClass("red"),$("#_picture").val("")})},onUploadComplete:function(){}})})},aq_teacher_avatar:function(){$(".aqupload").each(function(){var node=$(this),upload_id=node.attr("id");$("#"+upload_id).uploadify({formData:$.tizi_token({session_id:$.cookies.get(baseSessID)},"post"),swf:staticBaseUrlName+staticVersion+"lib/uploadify/2.2/uploadify.swf",uploader:baseUrlName+"upload/taqask?id="+upload_id,multi:!1,buttonClass:"choseFileBtn",buttonText:"更换头像",fileTypeExts:"*.jpg; *.png;*.gif",fileSizeLimit:"512KB",fileObjName:upload_id,width:102,height:28,overrideEvents:["onSelectError","onDialogClose"],onUploadStart:function(){},onSWFReady:function(){},onFallback:function(){$(".imgTips").html(noflash)},onSelectError:function(file,errorCode){switch(errorCode){case-110:$.tiziDialog({content:"文件 ["+file.name+"] 过大！每张图片不能超过0.5M"});break;case-120:$.tiziDialog({content:"文件 ["+file.name+"] 大小异常！不可以上传大小为0的文件"});break;case-130:$.tiziDialog({content:"文件 ["+file.name+"] 类型不正确！不可以上传错误的文件格式"})}return!1},onUploadSuccess:function(file,data){var json=JSON.parse(data),img_path="";1==json.code?(img_path=json.img_path,$("#_picture").val(img_path),$.tizi_ajax({url:baseUrlName+"aq_teacher/aq_teacher/edit_avatar",type:"POST",dataType:"json",data:{url:img_path},success:function(){$("."+upload_id).html('<img src="'+img_path+'" class="picture_urls"/>')},error:function(){}})):($("."+upload_id).html("<b>"+json.msg+"</b>"),$("."+upload_id).addClass("red"))},onUploadComplete:function(){}})})},aq_teacher_bindCheckInput:function(){var that=this,count=0;$("#subject_point input").click(function(){var oinput=$("#subject_point input");if(that.aq_teacher_point_input_checked(),$(this).attr("checked")?count+=1:count-=1,count>3)this.checked="",count-=1,that.aq_teacher_point_input_checked();else if(3==count)that.aq_teacher_point_input_checked();else for(var i=0;i<oinput.length;i++)oinput[i].parentNode.style.color="#000"})},aq_teacher_point_input_checked:function(){for(var count=0,point_input=$("#subject_point input"),i=0;i<point_input.length;i++){var arr=[];""==point_input[i].checked?arr.push(point_input[i]):count+=1;for(var j=0;j<arr.length;arr++)arr[j].checked="",arr[j].parentNode.style.color="#ccc"}},aq_teacher_add_answer:function(){$(".writedownanswer").click(function(){var str="";$("input[name='checkbox']:checked").each(function(){str+=$(this).val()+","}),TeacherAq.answerAdmin.setBtnClear($(this)),$.tizi_ajax({url:baseUrlName+"aq_teacher/aq_teacher/add_answer",type:"POST",dataType:"json",data:{question_id:$("#question_id").val(),text_answer:$("#content").html(),picture_url:$("#_picture").val(),diff:$('input[name="radio_diff"]:checked').val(),points:str},success:function(json){1==json.errorcode?($.tiziDialog({content:"操作成功",okc:function(){window.location.reload()}}),window.location.reload()):($.tiziDialog({content:json.error,okc:function(){window.location.reload()}}),window.location.reload())},error:function(){$.tiziDialog({content:"系统忙，请稍后再试",okc:function(){window.location.reload()}}),window.location.reload()}})})},setBtnClear:function(ele){var ele=ele;ele.css({background:"#eee",color:"#2a8d6a",border:"1px solid #ddd"}),ele.attr("disabled",!0)},scrollTitleMsgFn:function(){function scrollTitleMsg(){clearTimeout(_timerID),document.title=_text.substring(1,_text.length)+_text.substring(0,1),_text=document.title.substring(0,_text.length),_timerID=setTimeout(scrollTitleMsg,1e3)}var _timerID,_text="[新问题]有新的题目，请查看... ";scrollTitleMsg()}};